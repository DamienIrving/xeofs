
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/1eof/plot_eof-smode.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_1eof_plot_eof-smode.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_1eof_plot_eof-smode.py:


EOF analysis (S-mode)
========================

EOF analysis in S-mode maximises the temporal variance.

.. GENERATED FROM PYTHON SOURCE LINES 7-17

.. code-block:: default



    # Load packages and data:
    import xarray as xr
    import matplotlib.pyplot as plt
    from matplotlib.gridspec import GridSpec
    from cartopy.crs import Orthographic, PlateCarree

    from xeofs.xarray import EOF








.. GENERATED FROM PYTHON SOURCE LINES 18-21

.. code-block:: default


    t2m = xr.tutorial.load_dataset('air_temperature')['air']








.. GENERATED FROM PYTHON SOURCE LINES 22-23

Perform the actual analysis

.. GENERATED FROM PYTHON SOURCE LINES 23-30

.. code-block:: default


    model = EOF(t2m, n_modes=5, norm=False, dim='time')
    model.solve()
    expvar = model.explained_variance_ratio()
    eofs = model.eofs()
    pcs = model.pcs()








.. GENERATED FROM PYTHON SOURCE LINES 31-32

Create figure showing the first two modes

.. GENERATED FROM PYTHON SOURCE LINES 32-56

.. code-block:: default


    proj = Orthographic(central_latitude=30, central_longitude=-80)
    kwargs = {
        'cmap' : 'RdBu', 'vmin' : -.05, 'vmax': .05, 'transform': PlateCarree()
    }

    fig = plt.figure(figsize=(10, 10))
    gs = GridSpec(3, 4)
    ax1 = fig.add_subplot(gs[0, :])
    ax2 = fig.add_subplot(gs[1, 2:], projection=proj)
    ax3 = fig.add_subplot(gs[1, :2])
    ax4 = fig.add_subplot(gs[2, 2:], projection=proj)
    ax5 = fig.add_subplot(gs[2, :2])

    ax2.coastlines(color='.5')
    ax4.coastlines(color='.5')

    expvar.plot(ax=ax1, marker='.')
    eofs.sel(mode=1).plot(ax=ax2, **kwargs)
    pcs.sel(mode=1).plot(ax=ax3)
    eofs.sel(mode=2).plot(ax=ax4, **kwargs)
    pcs.sel(mode=2).plot(ax=ax5)
    plt.tight_layout()
    plt.savefig('eof-smode.jpg')



.. image-sg:: /auto_examples/1eof/images/sphx_glr_plot_eof-smode_001.png
   :alt: mode = 1, mode = 1, mode = 2, mode = 2
   :srcset: /auto_examples/1eof/images/sphx_glr_plot_eof-smode_001.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.933 seconds)


.. _sphx_glr_download_auto_examples_1eof_plot_eof-smode.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_eof-smode.py <plot_eof-smode.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_eof-smode.ipynb <plot_eof-smode.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
